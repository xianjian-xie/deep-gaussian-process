library(deepgp)
library(lhs)


seed <- 3
set.seed(seed)
layers <- 1 # 1, 2, or 3

n <- 10 # number of points in starting design
new_n <- 1 # number of points to add sequentially
m <- 100 # number of candidate and testing points
noise <- 0.1

g_0 <- 0.01
if (layers == 1) {
  theta_0 <- 0.5
} else if (layers == 2) {
  theta_y_0 <- 0.5
  theta_w_0 <- 1
  w_0 <- x
} else if (layers == 3) {
  theta_y_0 <- 0.5
  theta_w_0 <- 1
  theta_z_0 <- 1
  w_0 <- x
  z_0 <- x
}

x = c(1.36981,    -1.38577,
0.587107,    0.708629,
1.11078 ,   -1.35198,
0.604678,   -0.113224,
-1.09662,     0.86328,
-1.93585,    -2.09702,
-0.796596,    0.589165,
-0.172759 ,   0.317555,
0.414028 ,   0.952823,
-1.8498,   -0.231656,
1.11212 ,     0.4542,
0.711986 ,   -1.96284,
-0.0535862,   0.0855292,
1.35658 ,    1.17783,
-1.29087 ,    0.13915,
0.765691  ,  -1.04417,
-0.13442   , 0.297845,
-1.0086  ,  0.890088,
0.311205  ,  0.482937,
-0.00486998,     1.22764)

x = aperm(array(data=x,dim=c(2,20)), c(2,1))


y = c(-0.766594,
-0.522244,
-0.722181,
-0.562775,
 0.529142,
  2.80303,
 0.166224,
-0.266232,
-0.460391,
  2.62303,
-0.655071,
-0.667461,
 -0.33331,
-0.675061,
 0.760724,
-0.641081,
-0.285415,
 0.416961,
-0.449543,
-0.291749)

# y = c(620.57367631467,
# 752.24841881802,
# 644.50680667793,
# 730.40742820559,
# 1318.8190366267,
# 2544.1687520541,
# 1123.2497819142,
# 890.20841178219,
# 785.58007513861,
# 2447.1709055976,
# 680.67093212431,
# 673.99421331464,
# 854.06150079915,
# 669.89845396473,
# 1443.6138358086,
# 688.20971091298,
# 879.87094831937,
# 1258.3665782294,
# 791.42543582816,
# 876.4576049437)

# xp = c(9.9060834670558,9538.8123000875,
# 7.8816641402273,10706.79392764,
# 9.2361114002469,9557.6568044955,
# 7.9271109137325,10248.472855494,
# 3.5268111307236,10793.038254447,
# 1.356217700982,9142.1718696185,
# 4.3028141640974,10640.172680816,
# 5.9163246595189,10488.704623153,
# 7.434008688558,10842.973207891,
# 1.5787749487525,10182.426944272)


xp = c(0.9060834670558,0.8123000875,
0.8816641402273,0.79392764)


xp = aperm(array(data=xp,dim=c(2,2)), c(2,1))


fit <- fit_one_layer(x, y, nmcmc = 10000, verb = FALSE)
# fit <- trim(fit, 5000, 2)

# fit <- predict(fit, xp, lite = FALSE)

# cat('predict mean', fit$mean)



